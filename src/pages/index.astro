---
import { getCollection } from "astro:content";
import MainLayout from "../layouts/MainLayout.astro";
import ArticleCard from "../components/ArticleCard.astro";
import { sortByDate } from "../js/utils";

const articles = await getCollection("blog", ({ data }) => {
  return data.draft !== true;
});
sortByDate(articles);

const title = "Home";
---

<MainLayout {title}>
  <section class="about-me" aria-labelledby="about-me-title">
    <!-- TODO: improve portrait alt text -->
    <img class="portrait block-shadow" src="/images/portrait.jpg" alt="Alessandro Bozzoli portrait" />
    <div class="intro-text">
      <hgroup>
        <h2 id="about-me-title" class="mb-0">Alessandro Bozzoli</h2>
        <p>Frontend Developer</p>
      </hgroup>
      <p>
        Serial overthinker,<br />
        fervently passionate about<br />
        <strong>CSS</strong> and <strong>accessibility</strong>.
      </p>
    </div>
  </section>

  <h2 id="latest-articles-title">Latest articles</h2>
  <ul class="card-stack" role="list" aria-labelledby="latest-articles-title">
    {articles.slice(0, 3).map((article) => <ArticleCard {article} hLevel="h3" />)}
  </ul>
</MainLayout>

<style lang="scss">
  .about-me {
    display: flex;
    column-gap: 16px;
    margin-bottom: 48px;

    .portrait {
      width: 140px;
      height: 160px;
      aspect-ratio: 1;
    }

    .intro-text {
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;

      > p {
        font-size: var(--fs-20px);
      }
    }
  }

  @media (max-width: 576px) {
    /* TODO */
  }
</style>
