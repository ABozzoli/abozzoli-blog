---
import { getCollection } from "astro:content";
import PostCard from "../../components/PostCard.astro";
import MainLayout from "../../layouts/MainLayout.astro";
import type { GetStaticPaths } from "astro";

export const getStaticPaths = (async ({ paginate }) => {
  const posts = await getCollection("blog", ({ data }) => {
    return data.draft !== true;
  });

  const pages = paginate(posts, { pageSize: 2 });
  return pages;
}) satisfies GetStaticPaths; //https://github.com/withastro/astro/issues/6507#issuecomment-1489916992

const { page } = Astro.props;

const title = "Blog";
---

<MainLayout {title}>
  <h1>{title}</h1>
  <div class="cards-grid">
    {page.data.map((post) => <PostCard {post} hLevel="h3" />)}
  </div>
</MainLayout>

<style>
  .cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1rem;
  }
</style>
